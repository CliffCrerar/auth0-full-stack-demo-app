<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configuring | SI App demo</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="https://vuepress.vuejs.org/logo.png">
    <meta name="description" content="Documentation">
    <link rel="preload" href="/docs/assets/css/0.styles.2ffe55c2.css" as="style"><link rel="preload" href="/docs/assets/js/app.8d05c1b9.js" as="script"><link rel="preload" href="/docs/assets/js/2.62e0e541.js" as="script"><link rel="preload" href="/docs/assets/js/9.813d7841.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.2f62c93c.js"><link rel="prefetch" href="/docs/assets/js/3.027b5d8e.js"><link rel="prefetch" href="/docs/assets/js/4.abd0efef.js"><link rel="prefetch" href="/docs/assets/js/5.0388998a.js"><link rel="prefetch" href="/docs/assets/js/6.87b82886.js"><link rel="prefetch" href="/docs/assets/js/7.540e858c.js"><link rel="prefetch" href="/docs/assets/js/8.9259d13b.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.2ffe55c2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">SI App demo</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐Back to App
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/docs/requirements/" class="nav-link">
  Requirements
</a></div><div class="nav-item"><a href="/docs/configuration/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Config
</a></div><div class="nav-item"><a href="/docs/application/" class="nav-link">
  Application
</a></div><div class="nav-item"><a href="/docs/api/" class="nav-link">
  JSON API
</a></div><div class="nav-item"><a href="/docs/authentication/" class="nav-link">
  Authentication
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐Back to App
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/docs/requirements/" class="nav-link">
  Requirements
</a></div><div class="nav-item"><a href="/docs/configuration/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Config
</a></div><div class="nav-item"><a href="/docs/application/" class="nav-link">
  Application
</a></div><div class="nav-item"><a href="/docs/api/" class="nav-link">
  JSON API
</a></div><div class="nav-item"><a href="/docs/authentication/" class="nav-link">
  Authentication
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Configuring</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/configuration/#the-code" class="sidebar-link">The Code</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/configuration/#structure" class="sidebar-link">Structure</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/configuration/#configuring-authentication" class="sidebar-link">Configuring authentication.</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/configuration/#data-utilities" class="sidebar-link">Data utilities</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/configuration/#ci-cd" class="sidebar-link">CI/CD</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/configuration/#containerization" class="sidebar-link">Containerization</a></li><li class="sidebar-sub-header"><a href="/docs/configuration/#testing" class="sidebar-link">Testing</a></li><li class="sidebar-sub-header"><a href="/docs/configuration/#build-process" class="sidebar-link">Build process</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="configuring-to-run"><a href="#configuring-to-run" class="header-anchor">#</a> Configuring to run</h1> <h2 id="the-code"><a href="#the-code" class="header-anchor">#</a> The Code</h2> <div class="language- extra-class"><pre class="language-text"><code>git clone https://github.com/CliffCrerar/auth0-full-stack-demo-app.git
</code></pre></div><h2 id="structure"><a href="#structure" class="header-anchor">#</a> Structure</h2> <ol><li><code>/app</code> - the <code>angular</code> application</li> <li><code>/api</code> - the express server</li></ol> <h2 id="configuring-authentication"><a href="#configuring-authentication" class="header-anchor">#</a> Configuring authentication.</h2> <p>Both parts of the app use a common secrets file named <code>auth.conf.json</code> that holds the secrets for authentication. Hence this file will not appear in the repository. It has the following structure and must reside in the root of the project where the application will look for it.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;DOMAIN&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;FE_CLIENT_ID&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;API_CLIENT_ID&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;AUDIENCE&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;JWKSURI&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ISSUER&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ALGORITHM&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;RS256&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="data-utilities"><a href="#data-utilities" class="header-anchor">#</a> Data utilities</h2> <p>The application uses a collection level document database as its data repository and it has been baked into the express server as middel-ware. The data client runs on port <code>5984</code> on the same origin as the express server. It uses leveldb and saves the data from its <code>tables</code> as files on the host drive inside the project.</p> <h2 id="ci-cd"><a href="#ci-cd" class="header-anchor">#</a> CI/CD</h2> <h3 id="containerization"><a href="#containerization" class="header-anchor">#</a> Containerization</h3> <p>The application builds with a customer container that has globally pre-installed <code>grunt-cli</code>, <code>@angular/cli</code> and <code>vuepress</code>.</p> <h3 id="testing"><a href="#testing" class="header-anchor">#</a> Testing</h3> <p>This project does not yet have testing running. In production TDD is should be non-negotiable.</p> <h3 id="build-process"><a href="#build-process" class="header-anchor">#</a> Build process</h3> <p>The build process is handled with <code>grunt</code>. See the simple <code>gruntfile.js</code> below.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> grunt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'grunt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">options</span><span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> execOptions<span class="token operator">:</span> <span class="token punctuation">{</span> cwd<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

grunt<span class="token punctuation">.</span><span class="token function">initConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    shell<span class="token operator">:</span> <span class="token punctuation">{</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span> stderr<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        installApi<span class="token operator">:</span> <span class="token punctuation">{</span>
            command<span class="token operator">:</span> <span class="token string">'npm install'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token function">options</span><span class="token punctuation">(</span><span class="token string">'api'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        buildApp<span class="token operator">:</span> <span class="token punctuation">{</span>
            command<span class="token operator">:</span> <span class="token string">'npm install; npm run build'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token function">options</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        buildDocs<span class="token operator">:</span> <span class="token punctuation">{</span>
            command<span class="token operator">:</span> <span class="token string">'npm install; npm run docs:build'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        copyApp<span class="token operator">:</span> <span class="token punctuation">{</span>
            command<span class="token operator">:</span> <span class="token string">'mv ./app/dist/products-app ./api/src/app'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        copyDocs<span class="token operator">:</span> <span class="token punctuation">{</span>
            command<span class="token operator">:</span> <span class="token string">'mv ./docs/.vuepress/dist ./api/src/docs'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

grunt<span class="token punctuation">.</span><span class="token function">loadNpmTasks</span><span class="token punctuation">(</span><span class="token string">'grunt-shell'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
grunt<span class="token punctuation">.</span><span class="token function">registerTask</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'shell'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="gcp-cloud-build-service"><a href="#gcp-cloud-build-service" class="header-anchor">#</a> GCP Cloud build service</h1> <p><img src="https://cdn-cloudflare.ga/assets/site-logo/gcloud-build/gcloud-build.jpg" alt="gcloud-build-image"></p> <p><a href="https://sonarcloud.io/dashboard?id=CliffCrerar_auth0-full-stack-demo-app" target="_blank" rel="noopener noreferrer"><img src="https://sonarcloud.io/images/project_badges/sonarcloud-white.svg" alt="SonarCloud"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>The container is deployed to google cloud build by run of the <code>npm run gcloud:build</code>. This uses a the config <code>cloudbuild.yml</code>. The command attached to the <code>npm</code> script is the same as push command to <code>docker hub</code> except that it publishes to a container registry in the private project.</p> <h1 id="deploy-with-google-cloud-run"><a href="#deploy-with-google-cloud-run" class="header-anchor">#</a> Deploy with google cloud run</h1> <p>Once the container is built it is deployed to cloud run to run as a cold starting container. In production Google then gradually moves the traffic from an existing release to the new release of your <code>SaaS</code>.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.8d05c1b9.js" defer></script><script src="/docs/assets/js/2.62e0e541.js" defer></script><script src="/docs/assets/js/9.813d7841.js" defer></script>
  </body>
</html>
